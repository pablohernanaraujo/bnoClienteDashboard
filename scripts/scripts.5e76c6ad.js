"use strict";angular.module("dashApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","firebase","ui.materialize","validation.match"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/ingresar.html",controller:"IngresarCtrl",controllerAs:"ingresar"}).when("/registrarse",{templateUrl:"views/registrarse.html",controller:"RegistrarseCtrl",controllerAs:"registrarse"}).when("/dashboard",{templateUrl:"views/dashboard.html",controller:"DashboardCtrl",controllerAs:"dashboard",resolve:{currentAuth:["Authentication",function(a){return a.requireAuth()}]}}).when("/dashboard/:id",{templateUrl:"views/dashboardDetails.html",controller:"DashboardDetailsCtrl",controllerAs:"dashboardDetails",resolve:{currentAuth:["Authentication",function(a){return a.requireAuth()}]}}).otherwise({redirectTo:"/"})}]),angular.module("dashApp").controller("IngresarCtrl",["$rootScope","$scope","Authentication",function(a,b,c){a.PAGE="ingresar",b.userLogin=function(){c.login(b.user)}}]),angular.module("dashApp").controller("RegistrarseCtrl",["$rootScope","$scope","Authentication",function(a,b,c){a.PAGE="registrarse",b.userRegister=function(){c.register(b.user)}}]),angular.module("dashApp").controller("DashboardCtrl",["$rootScope","$scope","Authentication","firebase","$firebaseObject","$timeout","$interval",function(a,b,c,d,e,f,g){b.userLogout=function(){c.logout()};var h,i=function(){if(a.clienteUid){var c=d.database().ref("/clientes/"+a.clienteUid);b.cliente=e(c),f(function(){d.database().ref("/lugares/"+a.clienteUid).on("value",function(a){var c=a.val();null!==c?b.lugares=c:b.lugares=!1})},10),g.cancel(j)}},j=g(function(){i()},200);b.editar=function(a){if(b.eNombre=!1,b.eApellido=!1,h!==a)switch(h=a,a){case"eNombre":b.eNombre=!0;break;case"eApellido":b.eApellido=!0;break;default:b.eNombre=!1,b.eApellido=!1}else b.eNombre=!1,b.eApellido=!1,h=""},b.crearLugar=function(){c.crearLugar(b.lugar),b.lugar=null,b.myformlugar.$setPristine(),b.myformlugar.$setUntouched(),$("#lugarLabel").toggleClass("active")},$(document).ready(function(){$(".collapsible").collapsible({accordion:!1})})}]),angular.module("dashApp").controller("DashboardDetailsCtrl",["$rootScope","$scope","firebase","$firebaseObject","$routeParams","$timeout",function(a,b,c,d,e,f){var g=c.database().ref("/lugares/"+a.clienteUid+"/"+e.id);b.lugar=d(g);var h;b.editar=function(a){if(b.eNombre=!1,b.eTipo=!1,h!==a)switch(h=a,a){case"eNombre":b.eNombre=!0;break;case"eTipo":b.eTipo=!0;break;default:b.eNombre=!1,b.eTipo=!1}else b.eNombre=!1,b.eTipo=!1,h=""},$(document).ready(function(){$("select").material_select(),$("ul.tabs").tabs()})}]),angular.module("dashApp").factory("Authentication",["$rootScope","firebase","$firebaseObject","$location","$timeout",function(a,b,c,d,e){var f={apiKey:"AIzaSyAwP6I2Nfx0G-pb6yp_Jm389xpUW2GjJRc",authDomain:"bno.firebaseapp.com",databaseURL:"https://bno.firebaseio.com",storageBucket:"firebase-bno.appspot.com"},g=b.initializeApp(f),h=g.auth(),i=g.database();h.onAuthStateChanged(function(b){if(b){a.navegador=!0,a.cargoTodo=!0;var f=i.ref("/clientes/"+b.uid),g=c(f);a.currentUser=g,a.clienteUid=b.uid,Materialize.toast("Bienvenido!",4e3),e(function(){d.path("/dashboard")})}else a.currentUser="",a.navegador=!1,a.cargoTodo=!0,e(function(){d.path("/")})});var j=function(){var a=b.auth().currentUser;a||d.path("/")};return{requireAuth:function(){return j()},login:function(b){a.authLoading=!0,h.signInWithEmailAndPassword(b.email,b.password)["catch"](function(b){b?(a.authLoading=!1,Materialize.toast(b.message,4e3,"red lighten-1")):a.authLoading=!1})},logout:function(){h.signOut().then(function(){},function(a){Materialize.toast(a.message,4e3,"red lighten-1")})},crearLugar:function(b){a.authLoading=!0;var c=i.ref("lugares/"+a.clienteUid).push(),d=c.key,e={nombre:b,status:1,key:d};c.set(e),a.authLoading=!1},register:function(b){a.authLoading=!0,h.createUserWithEmailAndPassword(b.email,b.password).then(function(c){i.ref("clientes").child(c.uid).set({regCliente:c.uid,nombre:b.nombre,apellido:b.apellido,email:b.email,status:1}),a.authLoading=!1})["catch"](function(b){b.code,b.message;Materialize.toast(b.message,4e3,"red lighten-1"),a.authLoading=!1})}}}]),angular.module("dashApp").run(["$templateCache",function(a){a.put("views/dashboard.html",'<div class="container white-text"> <div class="row"> <h5 style="margin: 25px 0" class="color-principal">Datos personales</h5> <div class="divider"></div> <div class="section" style="position:relative; height:130px"> <a ng-click="editar(\'eNombre\')" class="btn-floating waves-effect waves-light bg-principal" style="position:absolute;right:10px;top:10px"> <i class="material-icons">mode_edit</i> </a> <h5>Nombre</h5> <p class="switchAnimation" ng-show="!eNombre">{{cliente.nombre}}</p> <input class="switchAnimation" style="margin-top:2px" ng-show="eNombre" ng-model="cliente.nombre" ng-change="cliente.$save()" id="nombre" type="text"> </div> <div class="divider"></div> <div class="section" style="position:relative; height:130px"> <a ng-click="editar(\'eApellido\')" class="btn-floating waves-effect waves-light bg-principal" style="position:absolute;right:10px;top:10px"> <i class="material-icons">mode_edit</i> </a> <h5>Apellido</h5> <p class="switchAnimation" ng-show="!eApellido">{{cliente.apellido}}</p> <input class="switchAnimation" style="margin-top:2px" ng-show="eApellido" ng-model="cliente.apellido" ng-change="cliente.$save()" id="apellido" type="text"> </div> <div class="divider"></div> <h5 style="margin: 25px 0" class="color-principal">Crea un nuevo lugar</h5> <form name="myformlugar" ng-submit="crearLugar()"> <div class="input-field"> <i class="material-icons prefix">place</i> <input id="lugar" type="text" ng-model="lugar" required> <label id="lugarLabel" for="lugar">Ingrese el nombre del lugar</label> </div> <button type="submit" class="waves-effect waves-light btn bg-principal" style="width: 100%" ng-disabled="myformlugar.$invalid || authLoading"> crear </button> </form> <h5 style="margin: 25px 0" class="color-principal">Lista de lugares</h5> <div ng-show="lugares" class="collection"> <a href="#/dashboard/{{place.key}}" class="collection-item bg-segundo white-text" ng-repeat="place in lugares"> {{place.nombre}} </a> </div> <p ng-show="!lugares">No tienes ningun lugar creado</p> </div> </div>'),a.put("views/dashboardDetails.html",'<div class="row"> <div class="col m4"> <h5 style="margin: 70px 0 25px" class="color-principal">Vista previa</h5> <div class="divider"></div> <div class="row"> <div class="col s12"> <ul class="tabs"> <li class="tab col s3"><a class="active" href="#test1">Lista</a></li> <li class="tab col s3"><a href="#test2">Individual</a></li> </ul> </div> <div id="test1" class="col s12"> <div class="centrarImagen"> <img class="responsive-img" src="../images/privadoDisco.7a5d3fca.png"> </div> </div> <div id="test2" class="col s12"> <dic class="centrarImagen"> <img class="responsive-img" src="../images/privadoIndividual.fa94ac0a.png"> </dic> </div> </div> </div> <div class="col s12 m8 white-text"> <a class="waves-effect waves-light btn bg-principal" style="margin-top: 10px" href="#/dashboard"> <i class="material-icons left">keyboard_arrow_left</i> Volver </a> <h5 style="margin: 25px 0" class="color-principal">Lugar datos</h5> <div class="divider"></div> <div class="section" style="position:relative; height:130px"> <a ng-click="editar(\'eNombre\')" class="btn-floating waves-effect waves-light bg-principal" style="position:absolute;right:10px;top:10px"> <i class="material-icons">mode_edit</i> </a> <h5>Nombre</h5> <p class="switchAnimation" ng-show="!eNombre">{{lugar.nombre}}</p> <input class="switchAnimation" style="margin-top:2px" ng-show="eNombre" ng-model="lugar.nombre" ng-change="lugar.$save()" id="nombre" type="text"> </div> <div class="divider"></div> <div class="section" style="position:relative; height:130px"> <a ng-click="editar(\'eTipo\')" class="btn-floating waves-effect waves-light bg-principal" style="position:absolute;right:10px;top:10px"> <i class="material-icons">mode_edit</i> </a> <h5>Tipo <span>Debe seleccionar un tipo de lugar en editar modo.</span></h5> <p class="switchAnimation" ng-show="!eTipo">{{lugar.tipo}}</p> <div class="switchAnimation" input-field ng-show="eTipo" style="width:100%;margin-top:-12px"> <select ng-change="lugar.$save()" ng-model="lugar.tipo" material-select watch> <option value="" disabled selected>Seleciona una opcion</option> <option value="Disco">Disco</option> <option value="Bar">Bar</option> </select> </div> </div> <div class="divider"></div> </div> </div>'),a.put("views/ingresar.html",'<div class="bg"> <div class="container white-text"> <div class="row"> <form name="myformlogin" ng-submit="userLogin()" class="col m6 s12 offset-m6" style="margin-top:200px"> <h4 class="center-align">Ingrese sus datos</h4> <div class="input-field"> <input id="email" type="email" ng-model="user.email" required> <label for="email">Email</label> </div> <div class="input-field"> <input id="password" type="password" ng-model="user.password" required> <label for="password">Password</label> </div> <button type="submit" class="waves-effect waves-light btn bg-principal" style="width:100%" ng-disabled="myformlogin.$invalid || authLoading"> Ingresar </button> </form> </div> </div> </div>'),a.put("views/registrarse.html",'<div class="bg"> <div class="container white-text"> <div class="row"> <form name="myformregister" ng-submit="userRegister()" class="col m6 s12 offset-m6" style="margin-top:200px"> <h4 class="center-align">Registrarse</h4> <div class="input-field"> <input id="nombre" type="text" ng-model="user.nombre" required> <label for="nombre">Nombre</label> </div> <div class="input-field"> <input id="apellido" type="text" ng-model="user.apellido" required> <label for="apellido">Apellido</label> </div> <div class="input-field"> <input id="email" type="email" ng-model="user.email" required> <label for="email">Email</label> </div> <div class="input-field"> <input id="password" type="password" ng-model="user.password" required> <label for="password">Password</label> </div> <div class="input-field"> <input id="passwordConfirm" name="passwordConfirm" type="password" ng-model="passwordConfirm" match="user.password" match-ignore-empty="true" required> <label for="passwordConfirm">Confirmar contraseña</label> </div> <div class="match" ng-show="myformregister.passwordConfirm.$error.match">Contraseña no concuerda!</div> <button type="submit" class="waves-effect waves-light btn bg-principal" style="width:100%" ng-disabled="myformregister.$invalid || authLoading"> Ingresar </button> </form> </div> </div> </div>')}]);